In our database :


_id
6847a21d191b047eea2c6e19
name
"New Room"

attributes
Object
_class
"com.piseth.java.school.roomservice.domain.Room"

យើងមើលថា នៅក្រោម attributes វាមាន field ដទៃទៀតចឹង we can impoved it by put the condition inside the function. 

if(!sortField.contains(".")) {
			if(!sortField.equals("name")) {
				sortField = "attributes."+ filter;
			}
		}

បើវាមិនមាន . ហើយមិនមាន name (ចឹងមានន័យថា គេចង់ចូល sort by the field inside the attribute) 

==================================================================

public static Sort sort(RoomFilterDTO filter) {
		
		// sort direction 
		Sort.Direction direction = Sort.Direction.ASC;		
		if("desc".equalsIgnoreCase(filter.getDirection())) {
			direction =Sort.Direction.DESC;
		}		
		
		// sort field 		
		String sortField = filter.getSortBy();	
		
		if(!sortField.contains(".")) {
			if(!sortField.equals("name")) {
				sortField = "attributes."+ sortField;
			}
		}		
		return Sort.by(direction, sortField);

	}

=====================================================

Testing : 

GET: http://localhost:8080/api/rooms/search/pagination?page=0&size=4&sortBy=width&direction=asc

{
"page": 0,
"size": 4,
"totalElements": 6,
"totalPage": 2,
"content":[
{
"name": "Guest house",
"attributes":{"width": 3, "lengh": 6, "price": 60, "Have Fan": true}
},
{
"name": "A",
"attributes":{"width": 6, "lengh": 6, "price": 60, "Have Fan": true}
},
{
"name": "New Room",
"attributes":{"width": 6, "lengh": 8, "price": 30, "hasPacking": true, "HaveAC": true…}
},
{
"name": "Small Room",
"attributes":{"width": 7, "lengh": 8, "price": 80, "hasPacking": true, "HaveAC": true…}
}
]
}



















